{% extends 'base.html' %}

{% block content %}
    <a href = "/feeds/politician/{{ politician.id }}">뒤로 가기</a>
    
    <div class = "comment-box">
        {% if comments %}
            {% for c in comments %}
                <div class="card-comment">
                    {% comment %} <h3>{% c.author.profile.nickname %}</h3> {% endcomment %}
                    <div class="image">
                        {% if c.photo %}
                            <img src="{{ c.photo.url }}"  alt="" width="100%" height="100%">                    
                        {% endif %}
                    </div> 
                    <div class="text">
                        <h3>{{ c.content }}</h3>
                        
                        <div class="comment-info">
                            <h6>by {{ c.author.profile.nickname }}</h6>
                            <h6>{{ c.created_at }}</h6> 
                            <a href="/feeds/politician/{{ politician.id }}/normalfeed/{{ normalFeed.id }}/debate/comment/{{ c.id }}/like/"    
                               class = "material-icons mdl-badge comment-Like"     
                               data-pid={{ politician.id }} 
                               data-nfid={{ normalFeed.id }} 
                               data-cid={{ c.id }} 
                               data-csrfmiddlewaretoken="{{ csrf_token }}" 
                               data-badge="{{ c.like_users.count }}">LIKES</a>

                            <a href="/feeds/politician/{{ politician.id }}/normalfeed/{{ normalFeed.id }}/debate/comment/{{ c.id }}/dislike/" 
                               class = "material-icons mdl-badge comment-Dislike" 
                               data-pid={{ politician.id }} 
                               data-nfid={{ normalFeed.id }} 
                               data-cid={{ c.id }} 
                               data-csrfmiddlewaretoken="{{ csrf_token }}" 
                               data-badge="{{ c.dislike_users.count }}">DISLIKES</a>
                        </div>
                    
                    </div>
                    <div class="ctc-box">
                        {% for ctc in comments_to_comment|dictsort:"created_at" %}
                            {% if ctc.comment == c %}
                                <h5>{{ ctc.content }}</h5>
                                <h6>by {{ ctc.author.profile.nickname }}</h6>
                                <h6>{{ ctc.created_at }}</h6> 
                                <div class="ctc-wrapper">
                                    <a href="/feeds/politician/{{ politician.id }}/normalfeed/{{ normalFeed.id }}/debate/comment/{{ c.id }}/ctc/{{ ctc.id }}/like/"  
                                    class = "material-icons mdl-badge ctc-Like"     
                                    data-pid={{ politician.id }} 
                                    data-nfid={{ normalFeed.id }} 
                                    data-cid={{ c.id }} 
                                    data-ctcid={{ ctc.id }}
                                    data-csrfmiddlewaretoken="{{ csrf_token }}" 
                                    data-badge="{{ ctc.like_users.count }}">LIKES</a>

                                    <a href="/feeds/politician/{{ politician.id }}/normalfeed/{{ normalFeed.id }}/debate/comment/{{ c.id }}/ctc/{{ ctc.id }}/dislike/"
                                    class = "material-icons mdl-badge ctc-Dislike" 
                                    data-pid={{ politician.id }} 
                                    data-nfid={{ normalFeed.id }} 
                                    data-cid={{ c.id }} 
                                    data-ctcid={{ ctc.id }}
                                    data-csrfmiddlewaretoken="{{ csrf_token }}" 
                                    data-badge="{{ ctc.dislike_users.count }}">DISLIKES</a>
                                </div>
                            {% endif %}
                        {% endfor %}    
                    </div>
                    

                    <div class = "new-comment-wrapper">
                        <form action="/feeds/politician/{{ politician.id }}/normalfeed/{{ normalFeed.id }}/debate/comment/{{ c.id }}/new/" method="POST">
                            {% csrf_token %}
                            <div class="mdl-textfield mdl-js-textfield">
                                <input class="mdl-textfield__input" type="text" name="content">
                                <label class="mdl-textfield__label" for="sample1">New comment...</label>
                                <button  type="submit" class="mdl-button mdl-js-button mdl-button--icon">
                                    <i class="material-icons">send</i>
                                </button>
                            </div>
                        </form>
                    </div>
                    
                            
                </div>
            {% endfor %}
        {% else %}
            <h2>no comments yet</h2>
        {% endif %}

        <div class = "new-comment-wrapper">
            <form action="/feeds/politician/{{ politician.id }}/normalfeed/{{ normalFeed.id }}/debate/comment/new/" method="POST">
                {% csrf_token %}
                <div class="mdl-textfield mdl-js-textfield">
                    <input class="mdl-textfield__input" type="text" name="content">
                    <label class="mdl-textfield__label" for="sample1">New comment...</label>
                    <button  type="submit" class="mdl-button mdl-js-button mdl-button--icon">
                        <i class="material-icons">send</i>
                    </button>
                </div>
            </form>
        </div>

    </div>
{% endblock content %}

